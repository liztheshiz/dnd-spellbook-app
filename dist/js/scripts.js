let spellsRepository=function(){let e=[],t="https://www.dnd5eapi.co/api/spells/",n=["index","name","detailsUrl","level","school","castingTime","range","duration","areaOfEffect","classes","description","higherLevel"],i=document.querySelector(".spells-grid"),o=document.querySelector(".loading-overlay"),r=document.querySelector(".search-bar_input"),l=document.querySelector(".search-bar_button"),c=document.querySelector("#modal-container"),s=document.querySelector(".modal_title"),a=document.querySelector(".modal_subheading"),d=document.querySelector(".modal_info_casting-time"),u=document.querySelector(".modal_info_range"),f=document.querySelector(".modal_info_duration"),p=document.querySelector(".modal_info_area-of-effect"),h=document.querySelector(".show-more-button"),m=document.querySelector(".modal_description-wrapper"),g=document.querySelector(".modal_description"),L=document.querySelector(".modal-close");function y(e){e?o.classList.add("hidden"):o.classList.remove("hidden")}function v(e){y(!1),function(e){let t=e.detailsUrl;return fetch(t).then(function(e){return e.json()}).then(function(t){e.level=t.level,e.school=t.school,e.castingTime=t.casting_time,e.range=t.range,e.duration=t.duration,e.areaOfEffect=t.area_of_effect,e.classes=t.classes,e.description=t.desc,e.higherLevel=t.higher_level}).catch(function(e){console.error(e)})}(e).then(()=>(function(e){m.classList.add("hidden"),h.innerText="Show description",s.innerText=e.name,a.innerHTML=`Level ${e.level} ${e.school.name}`,d.innerHTML=`<h5>Casting Time</h5><p>${e.castingTime}</p>`,u.innerHTML=`<h5>Range</h5><p>${e.range}</p>`,f.innerHTML=`<h5>Duration</h5><p>${e.duration}</p>`;let t="<h5>Area of Effect</h5>";e.areaOfEffect?t+=`<p>${e.areaOfEffect.size} ft ${e.areaOfEffect.type}</p>`:t+="<p>none</p>";p.innerHTML=t;let n="";e.description.forEach(function(t,i){i===e.description.length-1||1===e.description.length?n+=`${t}`:n+=`${t}<br><br>`}),g.innerHTML=`Description:  ${n}`,c.classList.add("is-visible")})(e)).then(()=>y(!0))}function _(){c.classList.remove("is-visible")}return l.addEventListener("click",()=>{let t=function(t){let n=t.replace(/\s+/g,"-").toLowerCase(),i=e.filter(e=>e.index===n);return 1===i.length?i[0]:null}(r.value);t?v(t):alert('Spell not found! Please check your... "spell"-ing.')}),window.addEventListener("keydown",e=>{"Escape"===e.key&&c.classList.contains("is-visible")&&_()}),c.addEventListener("click",e=>{e.target===c&&_()}),L.addEventListener("click",_),h.addEventListener("click",()=>{m.classList.toggle("hidden"),m.classList.contains("hidden")?h.innerText="Show description":h.innerText="Hide description"}),{loadingMessageHidden:y,loadList:function(){return y(!1),fetch(t).then(function(e){return e.json()}).then(function(t){t.results.forEach(function(t){!function(t){"object"==typeof t&&Object.keys(t).every((e,t)=>e===n[t])&&e.push(t)}({index:t.index,name:t.name,detailsUrl:`https://www.dnd5eapi.co${t.url}`})})}).catch(function(e){y(!0),console.error(e)})},getAll:function(){return e},addGridItem:function(e){let t=document.createElement("div");t.classList.add("spells-grid_item");let n=document.createElement("h3");n.innerHTML=e.name,n.classList.add("spells-grid_item_title"),t.appendChild(n),i.appendChild(t),t.addEventListener("click",()=>v(e))}}}();spellsRepository.loadList().then(function(){spellsRepository.getAll().forEach(e=>spellsRepository.addGridItem(e)),spellsRepository.loadingMessageHidden(!0)});